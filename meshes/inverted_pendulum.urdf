<?xml version="1.0"?>
<robot name="inverted_pendulum">

    <!-- Base (fixed to the world origin) -->
    <link name="base">
        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="base.stl" scale="0.001 0.001 0.001" />
            </geometry>
            <material name="base_material">
                <color rgba="0.8 0.8 0.8 1.0"/>
            </material>
        </visual>
        <collision>
            <origin xyz="0 0 0.035" rpy="0 0 0" />
            <geometry>
                <cylinder radius="0.05" length="0.07"/>
            </geometry>
        </collision>
        <inertial>
            <origin xyz="0 0 0.035" rpy="0 0 0" />
            <mass value="0.5"/>
            <inertia ixx="0.001" ixy="0" ixz="0" 
                     iyy="0.001" iyz="0" 
                     izz="0.0015"/>
        </inertial>
    </link>

    <!-- Lid (fixed on top of the base) -->
    <link name="lid">
        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="lid.stl" scale="0.001 0.001 0.001" />
            </geometry>
            <material name="lid_material">
                <color rgba="0.2 0.2 0.8 1.0"/>
            </material>
        </visual>
        <collision>
            <origin xyz="0 0 0.005" rpy="0 0 0" />
            <geometry>
                <cylinder radius="0.04" length="0.01"/>
            </geometry>
        </collision>
        <inertial>
            <origin xyz="0 0 0.005" rpy="0 0 0" />
            <mass value="0.1"/>
            <inertia ixx="0.0001" ixy="0" ixz="0" 
                     iyy="0.0001" iyz="0" 
                     izz="0.0002"/>
        </inertial>
    </link>

    <!-- Fixed joint between base and lid -->
    <joint name="base_to_lid" type="fixed">
        <parent link="base" />
        <child link="lid" />
        <origin xyz="0 0 0.070" rpy="0 0 0" />
    </joint>

    <!-- Arm (actuated by stepper motor) -->
    <link name="arm">
        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="arm.stl" scale="0.001 0.001 0.001" />
            </geometry>
            <material name="arm_material">
                <color rgba="0.8 0.2 0.2 1.0"/>
            </material>
        </visual>
        <collision>
            <origin xyz="0.05 0 0.007" rpy="0 0 0" />
            <geometry>
                <box size="0.1 0.02 0.014"/>
            </geometry>
        </collision>
        <inertial>
            <origin xyz="0.05 0 0.007" rpy="0 0 0" />
            <mass value="0.05"/>
            <inertia ixx="0.000008" ixy="0" ixz="0" 
                     iyy="0.000042" iyz="0" 
                     izz="0.000042"/>
        </inertial>
    </link>

    <!-- Revolute joint for arm (actuated by stepper motor) -->
    <joint name="lid_to_arm" type="revolute">
        <parent link="lid" />
        <child link="arm" />
        <origin xyz="0 0 0.005" rpy="0 0 -1.57079" />
        <axis xyz="0 0 1" />
        <limit lower="-3.14159" upper="3.14159" effort="1.0" velocity="5.0" />
        <dynamics damping="0.001" friction="0.001"/>
    </joint>

    <!-- Pendulum (swings freely on the arm) -->
    <link name="pendulum">
        <visual>
            <origin xyz="0 0 0" rpy="3.14159 0 0" />
            <geometry>
                <mesh filename="pendulum.stl" scale="0.001 0.001 0.001" />
            </geometry>
            <material name="pendulum_material">
                <color rgba="0.2 0.8 0.2 1.0"/>
            </material>
        </visual>
        <collision>
            <origin xyz="0 0 -0.05" rpy="0 0 0" />
            <geometry>
                <cylinder radius="0.005" length="0.1"/>
            </geometry>
        </collision>
        <inertial>
            <origin xyz="0 0 -0.05" rpy="0 0 0" />
            <mass value="0.02"/>
            <inertia ixx="0.0000167" ixy="0" ixz="0" 
                     iyy="0.0000167" iyz="0" 
                     izz="0.0000003"/>
        </inertial>
    </link>

    <!-- Ball joint for pendulum (free swinging) -->
    <joint name="arm_to_pendulum" type="continuous">
        <parent link="arm" />
        <child link="pendulum" />
        <origin xyz="0.1 0 0.014" rpy="0 0 0" />
        <axis xyz="1 0 0" />
        <dynamics damping="0.0001" friction="0.0001"/>
    </joint>

</robot>
